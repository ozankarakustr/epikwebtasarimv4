import{j as e}from"./index-D8qOLjzl.js";import{u as r,a as t,r as a}from"./router-BngDsYxN.js";import{s as l}from"./supabase-Cx8sYzrH.js";import"./vendor-qOSuyabr.js";import"./index-DCdKxP6z.js";function s(){const s=r(),{id:i}=t(),[n,d]=a.useState(!0),[c,o]=a.useState(!1),[u,m]=a.useState(null),[x,p]=a.useState({title:"",slug:"",description:"",price:"",image_url:"",features:[""],is_active:!0,download_link:""}),[g,b]=a.useState(null);a.useEffect(()=>{i&&h()},[i]);const h=async()=>{try{const{data:e,error:r}=await l.from("products").select("*").eq("id",i).single();if(r)throw r;m(e),p({title:e.title,slug:e.slug,description:e.description,price:e.price.toString(),image_url:e.image_url||"",features:e.features.length>0?e.features:[""],is_active:e.is_active,download_link:e.download_link||""})}catch(e){s("/admin/urunler")}finally{d(!1)}};return n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):u?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ürün Düzenle"}),e.jsxs("p",{className:"text-gray-600",children:['"',u.title,'" ürününü düzenleyin']})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border",children:e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),o(!0);try{const{error:e}=await l.from("products").update({title:x.title,slug:x.slug,description:x.description,price:parseFloat(x.price),image_url:x.image_url||null,features:x.features.filter(e=>""!==e.trim()),is_active:x.is_active,download_link:x.download_link,updated_at:(new Date).toISOString()}).eq("id",i);if(e)throw e;s("/admin/urunler")}catch(r){alert("Ürün güncellenirken bir hata oluştu")}finally{o(!1)}},className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ürün Adı *"}),e.jsx("input",{type:"text",required:!0,value:x.title,onChange:e=>{return r=e.target.value,void p({...x,title:r,slug:(t=r,t.toLowerCase().replace(/ğ/g,"g").replace(/ü/g,"u").replace(/ş/g,"s").replace(/ı/g,"i").replace(/ö/g,"o").replace(/ç/g,"c").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())});var r,t},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ürün adını girin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL Slug *"}),e.jsx("input",{type:"text",required:!0,value:x.slug,onChange:e=>p({...x,slug:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"urun-adi"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"URL'de görünecek isim"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fiyat (₺) *"}),e.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",value:x.price,onChange:e=>p({...x,price:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Açıklama *"}),e.jsx("textarea",{required:!0,rows:4,value:x.description,onChange:e=>p({...x,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ürün açıklamasını girin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Görsel URL"}),e.jsx("input",{type:"url",value:x.image_url,onChange:e=>p({...x,image_url:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com/image.jpg"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Boş bırakılırsa otomatik görsel oluşturulur"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"download_link",className:"block text-sm font-medium text-gray-700 mb-2",children:"Satın Alma Linki"}),e.jsx("input",{type:"url",id:"download_link",value:x.download_link,onChange:e=>p({...x,download_link:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com/download"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Ürün satın alındıktan sonra yönlendirilecek indirme linki"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"product_file",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ürün Dosyası (ZIP)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors",children:[e.jsx("input",{type:"file",id:"product_file",accept:".zip,.rar",onChange:e=>{e.target.files&&e.target.files[0]&&b(e.target.files[0])},className:"hidden"}),e.jsxs("label",{htmlFor:"product_file",className:"cursor-pointer",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-upload-cloud-2-line text-2xl text-blue-600"})}),e.jsx("p",{className:"text-gray-600 mb-2",children:"ZIP dosyasını buraya sürükleyin veya seçin"}),e.jsx("p",{className:"text-sm text-gray-5",children:"Maksimum dosya boyutu: 50MB"})]}),g&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("i",{className:"ri-file-zip-line text-green-600 mr-2"}),e.jsx("span",{className:"text-green-700 font-medium",children:g.name})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Özellikler"}),e.jsxs("div",{className:"space-y-2",children:[x.features.map((r,t)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:r,onChange:e=>((e,r)=>{const t=[...x.features];t[e]=r,p({...x,features:t})})(t,e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Özellik açıklaması"}),x.features.length>1&&e.jsx("button",{type:"button",onClick:()=>(e=>{p({...x,features:x.features.filter((r,t)=>t!==e)})})(t),className:"text-red-600 hover:text-red-800",children:e.jsx("i",{className:"ri-delete-bin-line"})})]},t)),e.jsxs("button",{type:"button",onClick:()=>{p({...x,features:[...x.features,""]})},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Özellik Ekle"]})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:x.is_active,onChange:e=>p({...x,is_active:e.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Ürünü aktif olarak yayınla"})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:()=>s("/admin/urunler"),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors whitespace-nowrap",children:"İptal"}),e.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:c?"Kaydediliyor...":"Değişiklikleri Kaydet"})]})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Ürün bulunamadı"}),e.jsx("button",{onClick:()=>s("/admin/urunler"),className:"text-blue-600 hover:text-blue-800",children:"Ürünlere dön"})]})}export{s as default};
