import{j as e}from"./index-D8qOLjzl.js";import{r as s,u as t,L as r}from"./router-BngDsYxN.js";import{c as a}from"./index-DCdKxP6z.js";import"./vendor-qOSuyabr.js";const i=a("https://dfjjsnoxkrmfrmksxfqm.supabase.co","sb_publishable_u1NZrF_BN2sDbJ4KyzOoNQ_krxzo2bb");function l(){const[a,l]=s.useState([]),[n,c]=s.useState(!0),[d,o]=s.useState("all"),[m,x]=s.useState(""),h=t();s.useEffect(()=>{p(),u()},[d]);const p=async()=>{const{data:{user:e}}=await i.auth.getUser();e||h("/admin/login")},u=async()=>{try{c(!0);let e=i.from("comments").select("\n          *,\n          posts (\n            title,\n            slug\n          )\n        ").order("created_at",{ascending:!1});"approved"===d?e=e.eq("is_approved",!0):"pending"===d&&(e=e.eq("is_approved",!1));const{data:s,error:t}=await e;if(t)throw t;l(s||[])}catch(e){}finally{c(!1)}},g=async(e,s)=>{try{const{error:t}=await i.from("comments").update({is_approved:s}).eq("id",e);if(t)throw t;await u()}catch(t){alert("İşlem sırasında bir hata oluştu.")}},b=a.filter(e=>""===m||e.nickname.toLowerCase().includes(m.toLowerCase())||e.content.toLowerCase().includes(m.toLowerCase())||e.email.toLowerCase().includes(m.toLowerCase())),j=a.filter(e=>!e.is_approved).length,f=a.filter(e=>e.is_approved).length;return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex items-center justify-between h-16",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>h("/admin"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors cursor-pointer",children:[e.jsx("i",{className:"ri-arrow-left-line text-xl"}),e.jsx("span",{children:"Admin Panel"})]}),e.jsx("div",{className:"w-px h-6 bg-gray-300"}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Yorum Yönetimi"})]})})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Toplam Yorum"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.length})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx("i",{className:"ri-chat-3-line text-2xl text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Onaylı Yorumlar"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:f})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx("i",{className:"ri-check-circle-line text-2xl text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Bekleyen Yorumlar"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:j})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center",children:e.jsx("i",{className:"ri-time-line text-2xl text-orange-600"})})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8 border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>o("all"),className:"px-4 py-2 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap "+("all"===d?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Tümü (",a.length,")"]}),e.jsxs("button",{onClick:()=>o("approved"),className:"px-4 py-2 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap "+("approved"===d?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Onaylı (",f,")"]}),e.jsxs("button",{onClick:()=>o("pending"),className:"px-4 py-2 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap "+("pending"===d?"bg-orange-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Bekleyen (",j,")"]})]}),e.jsxs("div",{className:"relative w-full md:w-80",children:[e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Yorum, nickname veya e-posta ara...",value:m,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-blue-600 animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Yorumlar yükleniyor..."})]})}):0===b.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-chat-3-line text-5xl text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Yorum bulunamadı"}),e.jsx("p",{className:"text-gray-600",children:m?"Arama kriterlerinize uygun yorum bulunamadı.":"Henüz hiç yorum yapılmamış."})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:b.map(s=>{return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:s.nickname.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.nickname}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(s.is_approved?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"),children:s.is_approved?"Onaylı":"Bekliyor"}),s.parent_id&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:"Yanıt"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsx("span",{children:s.email}),e.jsx("span",{children:(t=s.created_at,new Date(t).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}))}),s.posts&&e.jsx(r,{to:`/blog/${s.posts.slug}`,className:"text-blue-600 hover:text-blue-800 cursor-pointer",children:s.posts.title})]})]})]}),e.jsx("div",{className:"mb-4 ml-14",children:e.jsx("p",{className:"text-gray-800 leading-relaxed whitespace-pre-wrap",children:s.content})}),e.jsxs("div",{className:"flex items-center gap-6 ml-14 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-thumb-up-line"}),e.jsxs("span",{children:[s.likes," beğeni"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-thumb-down-line"}),e.jsxs("span",{children:[s.dislikes," beğenmeme"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[s.is_approved?e.jsx("button",{onClick:()=>g(s.id,!1),className:"px-3 py-1.5 bg-orange-600 text-white rounded-lg text-sm font-medium hover:bg-orange-700 transition-colors cursor-pointer whitespace-nowrap",children:"Gizle"}):e.jsx("button",{onClick:()=>g(s.id,!0),className:"px-3 py-1.5 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors cursor-pointer whitespace-nowrap",children:"Onayla"}),e.jsx("button",{onClick:()=>(async e=>{if(confirm("Bu yorumu silmek istediğinizden emin misiniz?"))try{const{error:s}=await i.from("comments").delete().eq("id",e);if(s)throw s;await u()}catch(s){alert("Yorum silinirken bir hata oluştu.")}})(s.id),className:"px-3 py-1.5 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition-colors cursor-pointer whitespace-nowrap",children:"Sil"})]})]})},s.id);var t})})})]})]})}export{l as default};
